# =============================================================================
# ETHHOOK PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# This file contains all environment variables needed for Railway.app deployment
# Copy this to your Railway project's environment variables

# =============================================================================
# NETWORK SELECTION (CRITICAL - Choose one)
# =============================================================================
# For MVP Demo: Use Sepolia testnet (free, safe for testing)
# For Production: Use Ethereum Mainnet (real money!)

ENVIRONMENT=development  # Options: development (Sepolia) | production (Mainnet)

# =============================================================================
# ALCHEMY RPC PROVIDER (Recommended - 300M compute units/month free)
# =============================================================================
# Sign up at: https://www.alchemy.com/
# Create apps for each network you want to support

# Sepolia Testnet (for demo/testing - FREE)
SEPOLIA_RPC_WS=wss://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY
SEPOLIA_RPC_HTTP=https://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY

# Ethereum Mainnet (for production - use with caution)
ETH_RPC_WS=wss://eth-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY
ETH_RPC_HTTP=https://eth-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY

# Arbitrum (optional - L2 scaling)
ARBITRUM_RPC_WS=wss://arb-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY
ARBITRUM_RPC_HTTP=https://arb-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY

# Optimism (optional - L2 scaling)
OPTIMISM_RPC_WS=wss://opt-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY
OPTIMISM_RPC_HTTP=https://opt-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY

# Base (optional - L2 scaling)
BASE_RPC_WS=wss://base-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY
BASE_RPC_HTTP=https://base-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY

# =============================================================================
# EVENT INGESTOR CONFIGURATION
# =============================================================================
# Which chain to monitor (use Sepolia for demo)
ETHEREUM_WS_URL=${{SEPOLIA_RPC_WS}}

# =============================================================================
# DATABASE CONFIGURATION (Managed by Railway)
# =============================================================================
# Railway automatically provisions PostgreSQL and sets DATABASE_URL
# No manual configuration needed!
# DATABASE_URL will be automatically set by Railway

DATABASE_MAX_CONNECTIONS=20
DATABASE_MIN_CONNECTIONS=5

# =============================================================================
# REDIS CONFIGURATION (Managed by Railway)
# =============================================================================
# Railway automatically provisions Redis and sets REDIS_URL
# No manual configuration needed!
# REDIS_URL will be automatically set by Railway

REDIS_POOL_SIZE=10
REDIS_HOST=redis.railway.internal  # Railway's internal DNS
REDIS_PORT=6379

# =============================================================================
# ADMIN API CONFIGURATION
# =============================================================================
API_HOST=0.0.0.0
API_PORT=3000

# JWT Secret (IMPORTANT: Generate a secure random string!)
# Generate with: openssl rand -base64 32
JWT_SECRET=CHANGE_THIS_TO_A_SECURE_RANDOM_STRING_MIN_32_CHARS

JWT_EXPIRATION_HOURS=24
API_RATE_LIMIT_PER_MINUTE=100

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Railway provides automatic HTTPS URLs
# Update this with your actual Railway frontend URL after deployment
CORS_ALLOWED_ORIGINS=https://your-frontend-url.up.railway.app

# =============================================================================
# WEBHOOK DELIVERY CONFIGURATION
# =============================================================================
WEBHOOK_TIMEOUT_SECONDS=30
WEBHOOK_MAX_RETRIES=5
WEBHOOK_WORKER_THREADS=50

# =============================================================================
# LOGGING & OBSERVABILITY
# =============================================================================
# Production logging level
RUST_LOG=info,ethhook=info,sqlx=warn

# Metrics
PROMETHEUS_METRICS_PORT=9090

# =============================================================================
# QUICK SETUP CHECKLIST
# =============================================================================
# ☐ 1. Sign up for Alchemy: https://www.alchemy.com/
# ☐ 2. Create Sepolia app, copy API key to SEPOLIA_RPC_WS and SEPOLIA_RPC_HTTP
# ☐ 3. Generate JWT_SECRET: openssl rand -base64 32
# ☐ 4. Deploy to Railway (DATABASE_URL and REDIS_URL auto-configured)
# ☐ 5. Update CORS_ALLOWED_ORIGINS with your Railway frontend URL
# ☐ 6. Verify all services are healthy
# ☐ 7. Create test endpoint and verify webhook delivery

# =============================================================================
# COST ESTIMATES (Monthly)
# =============================================================================
# - Alchemy Free Tier: $0 (300M compute units)
# - Railway PostgreSQL: $5-10
# - Railway Redis: $5-10
# - Railway Services (4 services): $15-20
# - Total: ~$25-40/month for full MVP
